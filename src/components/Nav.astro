---
// src/components/Nav.astro
const navLinks = [
  { href: "/work", text: "Web Design" },
  { href: "/writing", text: "Blog" },
  { 
    href: "/ai",
    text: "AI Solutions",
    isDropdown: true,
    subLinks: [
      { href: "/ai", text: "All Solutions" }, 
      { href: "/ai/prompt-engineering", text: "Prompt Engineering" },
      { href: "/ai/gpt-custom", text: "GPT Custom" },
      { href: "/ai/brand-visuals", text: "Brand Visuals" },
    ]
  },
  { href: "/contact", text: "Contact" },
];
---
<header class="w-full flex items-center justify-between p-4 bg-white shadow-sm sticky top-0 z-50">
  <a href="/" class="font-bold text-xl">CopyCodeAI</a>
  
  <!-- Menu Desktop (visibile da 'md' in su) -->
  <nav class="hidden md:flex items-center gap-6 text-gray-700">
    {navLinks.map(link => (
      !link.isDropdown ? (
        <a href={link.href} class="hover:text-blue-600 hover:underline">{link.text}</a>
      ) : (
        <div class="relative group">
          <a href={link.href} class="hover:text-blue-600 flex items-center gap-1 cursor-pointer">
            <span>{link.text}</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform duration-300 group-hover:rotate-180" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
          </a>
          <div class="absolute left-1/2 -translate-x-1/2 mt-2 w-56 bg-white border rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-10">
            <div class="py-1">
              {link.subLinks?.map(subLink => (
                <a href={subLink.href} class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">{subLink.text}</a>
                ))}
            </div>
          </div>
        </div>
      )
    ))}
  </nav>

  <!-- Bottone Hamburger (visibile solo fino a 'md') -->
  <div class="md:hidden">
    <button id="menu-btn" class="z-50 block hamburger md:hidden focus:outline-none">
      <span class="hamburger-top"></span>
      <span class="hamburger-middle"></span>
      <span class="hamburger-bottom"></span>
    </button>
  </div>
</header>

<!-- Menu Mobile (pannello a comparsa) -->
<div id="menu" class="fixed inset-0 z-40 flex-col items-center self-end w-full h-full m-h-screen px-6 py-1 pt-24 pb-4 tracking-widest bg-white bg-opacity-95 backdrop-blur-sm hidden">
  <div class="w-full py-3 text-center">
    {navLinks.map(link => (
      !link.isDropdown ? (
        <a href={link.href} class="block py-3 hover:text-blue-600">{link.text}</a>
      ) : (
        <div class="py-3">
          <a href={link.href} class="font-bold">{link.text}</a>
          <div class="flex flex-col items-center mt-2">
            {link.subLinks?.map(subLink => (
              <a href={subLink.href} class="block py-2 text-sm text-gray-600 hover:text-blue-600">{subLink.text}</a>
            ))}
          </div>
        </div>
      )
    ))}
  </div>
</div>

<script>
  const btn = document.getElementById('menu-btn');
  const menu = document.getElementById('menu');

  btn.addEventListener('click', () => {
    btn.classList.toggle('open');
    menu.classList.toggle('hidden');
    menu.classList.toggle('flex');
    document.body.classList.toggle('overflow-hidden');
  });

  menu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      btn.classList.remove('open');
      menu.classList.add('hidden');
      menu.classList.remove('flex');
      document.body.classList.remove('overflow-hidden');
    });
  });
</script>

<style>
  .hamburger { cursor: pointer; width: 24px; height: 24px; transition: all 0.25s; position: relative; }
  .hamburger-top, .hamburger-middle, .hamburger-bottom { position: absolute; width: 24px; height: 2px; top: 0; left: 0; background: #333; transform: rotate(0); transition: all 0.5s; }
  .hamburger-middle { transform: translateY(7px); }
  .hamburger-bottom { transform: translateY(14px); }
  .open { transform: rotate(90deg); }
  .open .hamburger-top { transform: rotate(45deg) translateY(6px) translateX(6px); }
  .open .hamburger-middle { display: none; }
  .open .hamburger-bottom { transform: rotate(-45deg) translateY(6px) translateX(-6px); }
</style>
