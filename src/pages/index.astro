---
export const prerender = true;

import SiteLayout from "@core/layouts/SiteLayout.astro";
import { sanityClient } from "../lib/sanity";

const SITE = "https://copycodeai-bki.pages.dev";
const url = SITE;
const description = "Copywriting, web development, and AI solutions for startups and freelancers who want to move fast.";

const services = [
  {
    title: "Copywriting & Content Writing",
    bullets: [
      'Naming, storytelling, and SEO-ready texts',
      'Articles and portfolio pieces to strengthen your brand',
      'Weekly updates with fresh content',
    ],
  },
  {
    title: "Web Development",
    bullets: [
      'Fast websites built with Astro + Tailwind',
      'Custom, responsive layouts',
      'Technical SEO optimization',
    ],
  },
  {
    title: "AI Solutions",
    bullets: [
      'Custom-built assistants and tools',
      'Generative visuals for marketing',
      'Automations that save time',
    ],
  },
];

const postsQuery = `
  *[_type == "post" && defined(slug.current)]
    | order(publishedAt desc)[0...3] {
      title,
      "slug": slug.current,
      excerpt,
      summary,
      publishedAt
    }
`;

let latestPosts = [];
let postsError: unknown = null;

try {
  latestPosts = await sanityClient.fetch(postsQuery);
} catch (error) {
  postsError = error;
}

const safeExcerpt = (post: any) => post?.excerpt ?? post?.summary ?? "";
const formatDate = (value?: string) => value ? new Date(value).toLocaleDateString("en-GB", { day: "2-digit", month: "short", year: "numeric" }) : "";
---

<SiteLayout title="CopyCodeAI — Copywriting, Web & AI" description={description} url={url}>
  <main class="mx-auto flex max-w-6xl flex-col gap-16 px-4 py-16">
    <section class="flex flex-col gap-6 text-center md:gap-8">
      <div class="space-y-4">
        <p class="font-sans text-sm uppercase tracking-[0.3em] text-[var(--muted)]">Copywriting · Web · AI</p>
        <h1 class="font-head text-4xl font-semibold text-[var(--text)] md:text-6xl">Copywriting, Web & AI Solutions for Startups and Freelancers</h1>
        <p
          class="mx-auto max-w-2xl text-lg text-[var(--muted)]"
          data-aos="fade-up"
        >
          Powerful copy, fast websites, and smart tools to grow your project online — without agency costs.
        </p>
      </div>
      <div
        class="flex flex-col items-center justify-center gap-4 sm:flex-row"
        data-aos="fade-up"
        data-aos-delay="120"
      >
        <a
          href="/contact"
          class="inline-flex items-center gap-2 rounded-lg bg-[var(--text)] px-6 py-3 font-semibold text-[var(--bg)] transition hover:opacity-90"
        >
          Start Your Project
          <span aria-hidden="true">↗</span>
        </a>
        <a
          href="#services"
          class="inline-flex items-center gap-2 rounded-lg border border-black/5 bg-[var(--surface)] px-6 py-3 font-semibold text-[var(--text)] shadow-sm transition hover:shadow-lg dark:border-white/10"
        >
          Explore Services
          <span aria-hidden="true">→</span>
        </a>
      </div>
    </section>

    <section class="mx-auto max-w-3xl space-y-4 text-center">
      <h2 class="font-head text-3xl text-[var(--text)]" data-aos="fade-up">A freelancer with the vision of a team.</h2>
      <p class="text-lg text-[var(--muted)]" data-aos="fade-up" data-aos-delay="100">
        I'm an independent professional: no bureaucracy, no inflated costs. Just tailored solutions for those who want to move fast with clear content, responsive websites, and intelligent strategies.
      </p>
    </section>

    <section class="space-y-8" id="services">
      <header>
        <h2 class="font-head text-3xl text-[var(--text)]" data-aos="fade-up">What I can do for you</h2>
        <p class="mt-2 max-w-2xl text-[var(--muted)]" data-aos="fade-up" data-aos-delay="100">Copywriting, development, and AI support aligned with what matters most: measurable growth without agency overhead.</p>
      </header>
      <div class="grid gap-6 md:grid-cols-3">
        {services.map((service, index) => (
          <article
            class="flex h-full flex-col gap-4 rounded-2xl border border-black/5 bg-[var(--surface)] p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-xl dark:border-white/10"
            data-aos="fade-up"
            data-aos-delay={index * 120}
          >
            <h3 class="font-head text-xl text-[var(--text)]">{service.title}</h3>
            <ul class="space-y-2 text-sm text-[var(--muted)]">
              {service.bullets.map((item) => (
                <li class="flex items-start gap-2">
                  <span aria-hidden="true" class="mt-1 h-2 w-2 flex-shrink-0 rounded-full bg-[var(--accent)]"></span>
                  <span>{item}</span>
                </li>
              ))}
            </ul>
          </article>
        ))}
      </div>
      <div class="flex justify-center" data-aos="fade-up" data-aos-delay={(services.length * 120) + 120}>
        <a
          href="/contact"
          class="inline-flex items-center gap-2 rounded-lg border border-[var(--accent)] px-6 py-3 font-semibold text-[var(--accent)] transition hover:bg-[var(--accent)] hover:text-white"
        >
          Explore Services
          <span aria-hidden="true">→</span>
        </a>
      </div>
    </section>

    <section class="space-y-6">
      <header class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
        <div>
          <h2 class="font-head text-3xl text-[var(--text)]">Latest writing</h2>
          <p class="text-[var(--muted)]">The latest case studies, prompt logs, and essays from the CopyCodeAI library.</p>
        </div>
        <a href="/writing" class="font-sans text-sm font-semibold text-[var(--accent)] hover:underline">View all →</a>
      </header>

      {postsError ? (
        <pre class="whitespace-pre-wrap rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-700 dark:border-red-500/40 dark:bg-red-500/10 dark:text-red-200">
          {String(postsError)}
        </pre>
      ) : latestPosts?.length ? (
        <div class="grid gap-6 md:grid-cols-3">
          {latestPosts.map((post, index) => (
            <a
              href={`/writing/${post.slug}`}
              class="flex flex-col gap-3 rounded-2xl border border-black/5 bg-[var(--surface)] p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-lg dark:border-white/10"
              data-aos="fade-up"
              data-aos-delay={index * 120}
            >
              <h3 class="font-head text-xl text-[var(--text)]">{post.title}</h3>
              {safeExcerpt(post) && (
                <p class="flex-1 text-sm text-[var(--muted)]">{safeExcerpt(post)}</p>
              )}
              <span class="text-xs uppercase tracking-widest text-[var(--muted)]">{formatDate(post.publishedAt)}</span>
            </a>
          ))}
        </div>
      ) : (
        <p class="text-[var(--muted)]">No stories yet — publish one from the CMS.</p>
      )}
    </section>

    <section class="grid gap-6 md:grid-cols-[1.4fr_1fr] md:items-center">
      <div class="space-y-4">
        <h2 class="font-head text-3xl text-[var(--text)]" data-aos="fade-up">Startups, Freelancers & Creators</h2>
        <p class="text-lg text-[var(--muted)]" data-aos="fade-up" data-aos-delay="100">
          Whether you're launching a startup, building your personal brand, or working as a freelancer, you need a website and content that speak for you. I help you develop them clearly, quickly, and without agency costs.
        </p>
        <a href="/hello" class="inline-flex items-center gap-2 font-semibold text-[var(--accent)] hover:underline" data-aos="fade-up" data-aos-delay="200">
          Discover how I work
          <span aria-hidden="true">→</span>
        </a>
      </div>
      <div
        class="rounded-2xl border border-black/5 bg-[var(--surface)] p-6 shadow-sm dark:border-white/10"
        data-aos="fade-up"
      >
        <p class="text-sm leading-relaxed text-[var(--muted)]" data-aos="fade-up" data-aos-delay="120">
          "From first draft to final deployment, I stay close to your project so messaging, design, and automation move in sync."
        </p>
      </div>
    </section>

    <section class="rounded-3xl border border-black/5 bg-[var(--surface)] p-10 text-center shadow-lg dark:border-white/10" data-aos="fade-up">
      <h2 class="font-head text-3xl text-[var(--text)]" data-aos="fade-up">Ready to grow your project?</h2>
      <p class="mt-3 text-[var(--muted)]" data-aos="fade-up" data-aos-delay="100">Let's build copy, websites, and AI systems that keep your momentum going.</p>
      <div class="mt-6 flex flex-col items-center justify-center" data-aos="fade-up" data-aos-delay="200">
        <a
          href="/contact"
          class="inline-flex items-center gap-2 rounded-lg bg-[var(--text)] px-6 py-3 font-semibold text-[var(--bg)] transition hover:opacity-90"
        >
          Contact Me Today
          <span aria-hidden="true">↗</span>
        </a>
      </div>
    </section>
  </main>
</SiteLayout>
